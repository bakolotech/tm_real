<style>

    .panier-main-mobile-section {
        width: 320px;
        height: 579px;
        background-color: #fff;
        border-radius: 6px;
    }

    .panier-mobile-header {
        height: 50.5px;
        width: 100%;
        display: flex;
        column-gap: 20px;
        align-items: center;
        justify-content: center;
        border-bottom: 1px solid #9B9B9B;
    }

    .panier-mobile-filter {
        height: 27px;
        width: 27px;
    }

    .panier-mobile-logo {

    }

    .panier-mobile-tm-logo {
        height: 24px;
        width: 125px;
    }

    .header-desction-devider {
        box-sizing: border-box;
        height: 45px;
        width: 1px;
        border: 1px solid #9B9B9B;
    }

    .panier-btn-step-active {
        height: 26px;
        width: 27px;
        border-radius: 4px;
        background-color: #1A7EF5;
        border: none;

        color: #FFFFFF;
        font-family: Roboto;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 0.26px;
        line-height: 14px;

    }

    .panier-btn-steps {
        height: 26px;
        width: 27px;
        border-radius: 4px;
        background-color: transparent;
        border: none;

        color: #9B9B9B;
        font-family: Roboto;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 0.26px;
        line-height: 14px;

    }

    .panier-btn-steps-succes {

        height: 26px;
        width: 27px;
        border-radius: 4px;
        background-color: transparent;
        border: 1px solid green;

        color: green;
        font-family: Roboto;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 0.26px;
        line-height: 14px;

    }

    .panier-mobile-filter {

    }

    .panier-mobile-prod-content {
        height: 447.5px;
        width: 100%;
        background-color: #fefefe;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 10px;
        overflow-y: scroll;
        overflow-x: hidden;
    }

    .panier-mobile-footer {
        height: 72px;
        width: 100%;
        background-color: #f1efef;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
    }

</style>

<style>

    .panier-mobile-prev {
        height: 37px;
        width: 37px;
        border-radius: 6px;
        background-color: #D8D8D8;
        border: none;
        color: #fff;
    }

    .panier-mobile-suivant {
        box-sizing: border-box;
        height: 37px;
        width: 140px;
        border: 1px solid #146FDA;
        border-radius: 6px;
        background: linear-gradient(270deg, #39B5FB 0%, #1A7EF5 100%);
        color: #fff;
        margin-left: 10px;
        font-family: Roboto;
        font-size: 16px;
        letter-spacing: 0;
        line-height: 14px;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;

    }

    .panier-mobile-footer-btn {
        display: flex;
    }

    .panier-mobile-prod-container {
        box-sizing: border-box;
        height: 38px;
        width: 302px;
        border: 1px solid #D8D8D8;
        border-radius: 6px 6px 0 0;
        background-color: #FFFFFF;
        display: flex;
    }

    .mobile-panier-articles {
        height: auto;
        width: 100%;
    }

    .box-container {
        width: 291px !important;
    }

</style>

<style>
    .fa-row-down-costum {
        margin-left: 30px;
        margin-top: 7px;
        font-size: 24px;
        font-weight: 100;
    }

    .mobile-panier-acordion-btn:hover {
        cursor: pointer;
    }

    .mobile-panier-libelle {
        height: auto;
        color: #191970;
        font-size: 16px;
        margin-right: 10px;
        line-height: 18px;
        margin-top: 10px;
        padding-top: 11px;
        position: relative;
        top: 7px;
    }

    .panier-mobile-recapitulatif-title h4 {
        height: 19px;
        width: 94px;
        color: #191970;
        font-family: Roboto;
        font-size: 16px;
        font-weight: 500;
        letter-spacing: 0;
        line-height: 19px;
    }

    .panier-mobile-promo-form {
        height: 78px;
        width: 302px;
        background-color: #FFFFFF;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .panier-mobile-recapilatif-prix {
        height: 127px;
        /* background-color: #D8D8D8; */
    }

    .mobile-panier-form-title {
        height: 11px;
        width: 200px;
        color: #545454;
        font-family: Roboto;
        font-size: 10px;
        letter-spacing: 0;
        line-height: 11px;
    }

</style>

<style>

    .panier-mobile-recapitulatif {
        width: 302px;
        margin-top: 10px;
    }

    .panier-mobile-form-btn {
        height: 37px;
        width: 87px;
        border-radius: 0 6px 6px 0;
        background-color: #007BFF;
        border: transparent;
        color: #fff;
    }

    .panier-form-input-code {
        height: 37px;
        width: 102px;
        color: #545454;
        font-family: Roboto;
        font-size: 12px;
        letter-spacing: 0;
        line-height: 14px;
    }

    .mobile-panier-code-promo {
        display: flex
    }

</style>

<style>

.obile-prix-ht {
color: #9B9B9B;
font-family: Roboto;
font-size: 12px;
letter-spacing: 0;
line-height: 14px;
}

.mobile-prix-ht-val {
color: #000000;
font-family: Roboto;
font-size: 12px;
letter-spacing: 0;
line-height: 14px;
text-align: right;
}

.mobile-reduction-label, .mobile-reduction-label-val {
color: #D0021B;
font-family: Roboto;
font-size: 12px;
letter-spacing: 0;
line-height: 14px;
}

.mobile-frais-label {
color: #9B9B9B;
font-family: Roboto;
font-size: 12px;
letter-spacing: 0;
line-height: 14px;
}

.mobile-frais-label-val {
    color: #000000;
    font-family: Roboto;
    font-size: 12px;
    letter-spacing: 0;
    line-height: 14px;
    text-align: right;
}

.panier-mobile-recapilatif-prix-child {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

</style>

<style>

   .section-identite-2, .section-identite-3 {
        margin-top: 10px;
    }

    .section-identite-1, .section-identite-2, .section-identite-3 {
        display: flex;
        width: 294px;
        margin-right: auto;
        margin-left: auto;
    }

    .mobile-panier-user-contact {
        color: #9B9B9B;
        font-family: Roboto;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 0;
        line-height: 14px;
        width: 269px
    }

    .mobile-panier-user-email {
        color: #000000;
        font-family: Roboto;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 0;
        line-height: 14px;
    }

    #mobile-panier-connection-container {
        display: flex;
        flex-direction: column;
    }

    .mobile-panier-user-contact-btn:hover {
        cursor: pointer;
    }

    .mobile-panier-paiement-card {
        width: 100%;
        height: 144px;
        display: flex;
        flex-direction: column;
        row-gap: 10px;
        position: relative;
    }

    .mobile-rectangle-card-vps {
        box-sizing: border-box;
        height: 28px;
        width: 302px;
        border: 0.5px solid #D0021B;
        border-radius: 6px;
        background-color: #FFFFFF;
        box-shadow: 0 0 4px 0 rgb(0 0 0 / 50%);
        position: relative;
    }

    .mobile-rectangle-card-vps:hover {
        cursor: pointer;
    }

    .panier-mobile-card-container {

        height: 144px;
        width: 102%;
        background-color: #fff;
        position: absolute;
        z-index: 10;

        display: flex;
        flex-direction: column;
        align-items: center;
        overflow-y: scroll;
        margin-left: -2px;
        margin-top: -2px;

    }

    .panier-mobile-hidden {
        display: none;
    }

    .tm_active_img_product-mobile {
        border: 1px solid #1A7EF5 !important;
        border-top: none !important;
    }

    #mobile-panier-back-btn {
        background: linear-gradient(270deg, #39B5FB 0%, #1A7EF5 100%) !important;
    }

</style>

 

<div class="panier-main-mobile-section" id="panier-main-mobile-section-id" style="position: relative;">

    <button id="exampleModal_bachirCloseds" type="button" class="close-btn-panier-bis" style="z-index: 15000; position:absolute;  margin-left: 301px; margin-top: -18px" onclick="closePanierMobileV2()">
        <img src="{{ asset('assets/images/close-btn.svg') }}" alt="">
    </button>

    <div class="panier-mobile-header">
        <div class="panier-mobile-logo"> 
            <img class="panier-mobile-filter" src="/assets/images/rayon-menu-icon.svg" alt="">
            <img class="panier-mobile-tm-logo" src="/assets/images/mobile_logo.png" alt="" />
        </div>
        <div class="header-desction-devider"></div>
        <div class="panier-mobile-steps">
            <button class="mobile-panier-step-1 panier-btn-step-active" id="mobile-nemu-panier">1</button>
            <button class="mobile-panier-step-2 panier-btn-steps" id="mobile-nemu-expedition">2</button>
            <button class="mobile-panier-step-3 panier-btn-steps" id="mobile-nemu-paiement">3</button>
            <button class="mobile-panier-step-4 panier-btn-steps" id="mobile-nemu-confirmation"><i class="fa fa-check" style="font-size: 13px; color:#9B9B9B"></i></button>
        </div>
    </div>

    <div class="panier-mobile-prod-content" >

        <div class="mobile-panier-step-1" id="mobile-panier-step-one">
           @include('front.new_view.panier_steps.panier_articles')
        </div>

        <div class="mobile-panier-step-2_0" id="mobile-panier-step-two_0" style="display: none">
            @include('front.new_view.panier_steps.panier_expedition')
        </div>

        <div class="mobile-panier-step-2" style="display: none" id="mobile-panier-step-two">
            @include('front.new_view.panier_steps.panier_paiement')
        </div>

    </div>

    <div class="panier-mobile-footer">
        <div class="panier-mobile-footer-btn">

            <button class="panier-mobile-prev" id="mobile-panier-back-btn" style="display: none; " onclick="mobile_panier_back()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
            </svg>
            </button>

            <button class="panier-mobile-suivant" onclick="changement_mobile()">
                <span>
                    CONTINUER
                </span>
                <span style="position: relative; margin-left: 10px">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                      </svg>
                </span>
            </button>

        </div>
    </div>


    <script src="{{ asset('js/panier/changement_mobile.js') }}"></script>
    <script src="{{ asset('js/panier/mobile_get_user_infos.js') }}"></script>
    <script src="{{ asset('js/panier/notify_me_onstock.js') }}"></script>

    <script>

function payer_via_mobile_service_mobile() {

var num_tel_client = 0

var request_ok = false;

let type_service = $('#mobileTypeService').val();
console.log('Le type service est bien => ', type_service)

if (type_service == 'MC') {
    num_tel_client = $('#phone-paiement-zone-moov-mobile').val();
}else if (type_service == 'AM') {
    num_tel_client = $('#phone-paiement-zone-mobile').val();
}

var request;

console.log('Le numero de telephone associé est bien => ', $('#phone-paiement-zone-mobile').val())

// var timerId = setInterval(() => {
$.ajax({
type: 'POST',
url: '/pay_with_mobile_service',
data: {type_service: type_service, num_tel: num_tel_client},
headers: {
    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
},
success: function(response) {  // ----- Retour de paiement

console.log('La reponse => ', response)

if(response['status'] == 'success') {
if (response['pvit_response'].STATUT == 200) { // premiere reponse pvit ok

var count_time = 0;

var ref = response['pvit_response'].REF
var user_email = response['user_meta_data'][0];
var date_livraison = response['user_meta_data'][1]

console.log('Ready to enter setInterval section ?')

const intervalId = setInterval(() => { // ----- Debut Interval
$.ajax({
type: 'GET',
url: '/get_pvit_callback/'+ref,
data: {},
success: function(callback_data) {

console.log('Les données retour callback sont => ', callback_data)

if (callback_data.length > 0 && callback_data[0].status_payement == 200) {

   $('#commande-user-email').text(user_email)
   $('#commande-user-numero').text(ref)
   $('#commande-user-date').text(date_livraison)

    // $('#bachir-loader').modal('hide');
    $('#bachir-loader').addClass('input-none-panier-v2')

    // $('#commandeSuccessModal').modal({
    //     backdrop: 'static',
    //     keyboard: false
    // })

    // $('#commandeSuccessModal').modal('show')
    $('#commandeSuccessModal').removeClass('input-none-panier-v2')

    clearInterval(intervalId)

} else {

count_time += 5000;

console.log('Le counter coninu et il est à :', count_time)

if (count_time >= 120000) {

console.log('Votre paiement n\'a pas abouti vous devez peut être réessayer')

$('#bachir-loader').addClass('input-none-panier-v2')

// $('#commandError').modal({
//     backdrop: 'static',
//     keyboard: false
// })

// $('#commandError').modal('show')
$('#commandError').removeClass('input-none-panier-v2')
clearInterval(intervalId)
}

}

}
}) // fin requete ajax
}, 5000)  // -------------- fin Interval ---------------

}else {

// $('#bachir-loader').modal('hide');
$('#bachir-loader').addClass('input-none-panier-v2')

// $('#commandError').modal({
//     backdrop: 'static',
//     keyboard: false
// })

// $('#commandError').modal('show')
$('#commandError').removeClass('input-none-panier-v2')
    console.log('Votre demande de payement n\'pas aboutit, cause: ', response['pvit_response'].MESSAGE)
}
}else if(response['message'] == 'error') {

    console.log('Supposé être dans la zone erreur ... ')

    // $('#bachir-loader').modal('hide');
    $('#bachir-loader').addClass('input-none-panier-v2')

    // $('#commandError').modal({
    //     backdrop: 'static',
    //     keyboard: false
    // })

    // $('#commandError').modal('show')
    $('#commandError').removeClass('input-none-panier-v2')

}

} // Fin success
})
}

function mobile_panier_back() {
    if ($('#mobile-nemu-paiement').hasClass('panier-btn-step-active')) {

        $('#mobile-nemu-paiement').removeClass('panier-btn-step-active')
        $('#mobile-nemu-paiement').addClass('panier-btn-steps')

        $('#mobile-nemu-expedition').removeClass('panier-btn-steps-succes')
        $('#mobile-nemu-expedition').addClass('panier-btn-step-active')

        $("#mobile-panier-step-two_0").show()
        $("#mobile-panier-step-two").hide()

    }else if($('#mobile-nemu-expedition').hasClass('panier-btn-step-active')) {

        $('#mobile-nemu-panier').removeClass('panier-btn-steps-succes')
        $('#mobile-nemu-panier').addClass('panier-btn-step-active')

        $('#mobile-nemu-expedition').removeClass('panier-btn-step-active')
        $('#mobile-nemu-expedition').addClass('panier-btn-steps')

        $("#mobile-panier-step-one").show()
        $("#mobile-panier-step-two").hide()
        $('#mobile-panier-step-two_0').hide()
        $('#mobile-panier-back-btn').hide()

    }
}

        function mobile_show_mode_paiement(id, type_service) {
            $('#phone-paiement-zone').val("")
            $('#phone-paiement-zone-moov').val("")
            $('#mobileTypeService').val(type_service)

            $('#panier-mobile-mode-paiement-'+id).removeClass('panier-mobile-hidden')
            $('.panier-mobile-card-container').removeClass('panier-mobile-hidden')
        }

    </script>

</div>
